{
  "id": "vishalbakshi/hms-hbac-training-spectrogram-images",
  "id_no": 4553461,
  "datasetSlugNullable": "hms-hbac-training-spectrogram-images",
  "ownerUserNullable": "vishalbakshi",
  "usabilityRatingNullable": 0.875,
  "titleNullable": "HMS HBAC Training Spectrogram Images",
  "subtitleNullable": "Black and White Images - Four Brain Region Spectrograms Stacked Vertically",
  "descriptionNullable": "This dataset is created from the training spectrogram `parquet` files provided in the [HMS - Harmful Brain Activity Classification](https://www.kaggle.com/competitions/hms-harmful-brain-activity-classification/overview). All images are 400 pixels in height and vary in width (median width of 311 pixels).\n\n[This notebook](https://www.kaggle.com/code/vishalbakshi/hms-hbac-fastai-planning-small-model-experiments) walks through the steps I used to create this dataset and explore the distribution of image widths across classes.\n\nHere is the main function, referenced from the [HMS-HBAC: KerasCV Starter Notebook](https://www.kaggle.com/code/awsaf49/hms-hbac-kerascv-starter-notebook) which takes the parquet files and converts them to images (`unique_df` is a `DataFrame` with a column of unique `spectrogram_id` values and associated metadata including the `target` class as determined by the maximum vote count):\n\n```python\ndef process_spec(spec_id, split=\"train\"):\n    # read the data\n    data = pd.read_parquet(path/f'{split}_spectrograms'/f'{spec_id}.parquet')\n    \n    # read the label\n    label = unique_df[unique_df.spectrogram_id == spec_id][\"target\"].item()\n    \n    # replace NA with 0\n    data = data.fillna(0)\n    \n    # convert DataFrame to array\n    data = data.values[:, 1:]\n    \n    # transpose\n    data = data.T\n    data = data.astype(\"float32\")\n    \n    # convert array to PILImage\n    im = PILImage.create(Image.fromarray((data * 255).astype(np.uint8)))\n    im.save(f\"{SPEC_DIR}/{split}_spectrograms/{label}/{spec_id}.png\")\n```\n\n## Image Count by Class\n\n|Class|Count|\t\n| --- | --- |\n|gpd_vote\t|1052|\n|grda_vote\t|1431|\n|lpd_vote\t|1302|\n|lrda_vote\t|693|\n|other_vote\t|4677|\n|seizure_vote\t|1983|\n\n## Image Height Statistics Overall\n\n|Stat|Value|\n| --- | --- |\n|count|11138.0|\n|mean|400.0|\n|std|0.0|\n|min|400.0|\n|25%|400.0|\n|50%|400.0|\n|75%|400.0|\n|max|400.0|\n\n## Image Width Statistics Overall\n\n|Stat|Value|\n| --- | --- |\n|count  |  11138.000000|\n|mean |      384.225714|\n|std   |     248.001019|\n|min   |     300.000000|\n|25%  |      301.000000|\n|50%  |      311.000000|\n|75%  |      354.000000|\n|max |      9116.000000|\n\n### Image Width Statistics By Class\n\n|Class|\t\t\tmean|\tmedian|\tmax|\tstd|\t\n| --- | --- | --- | --- | --- |\n|gpd_vote|\t435.895437|\t309.0|\t5281|\t348.815915|\n|grda_vote|\t360.069881|\t311.0|\t4038|\t183.385240|\n|lpd_vote|\t443.391705|\t315.0|\t9116|\t420.084127|\n|lrda_vote|\t376.523810|\t316.0|\t2950|\t189.161570|\n|other_vote|\t374.654907|\t304.0|\t5742|\t214.112803|\n|seizure_vote|\t360.663641|\t329.0|\t2631|\t124.085845|\n",
  "datasetId": 4553461,
  "datasetSlug": "hms-hbac-training-spectrogram-images",
  "hasDatasetSlug": true,
  "ownerUser": "vishalbakshi",
  "hasOwnerUser": true,
  "usabilityRating": 0.875,
  "hasUsabilityRating": true,
  "totalViews": 329,
  "totalVotes": 7,
  "totalDownloads": 24,
  "title": "HMS HBAC Training Spectrogram Images",
  "hasTitle": true,
  "subtitle": "Black and White Images - Four Brain Region Spectrograms Stacked Vertically",
  "hasSubtitle": true,
  "description": "This dataset is created from the training spectrogram `parquet` files provided in the [HMS - Harmful Brain Activity Classification](https://www.kaggle.com/competitions/hms-harmful-brain-activity-classification/overview). All images are 400 pixels in height and vary in width (median width of 311 pixels).\n\n[This notebook](https://www.kaggle.com/code/vishalbakshi/hms-hbac-fastai-planning-small-model-experiments) walks through the steps I used to create this dataset and explore the distribution of image widths across classes.\n\nHere is the main function, referenced from the [HMS-HBAC: KerasCV Starter Notebook](https://www.kaggle.com/code/awsaf49/hms-hbac-kerascv-starter-notebook) which takes the parquet files and converts them to images (`unique_df` is a `DataFrame` with a column of unique `spectrogram_id` values and associated metadata including the `target` class as determined by the maximum vote count):\n\n```python\ndef process_spec(spec_id, split=\"train\"):\n    # read the data\n    data = pd.read_parquet(path/f'{split}_spectrograms'/f'{spec_id}.parquet')\n    \n    # read the label\n    label = unique_df[unique_df.spectrogram_id == spec_id][\"target\"].item()\n    \n    # replace NA with 0\n    data = data.fillna(0)\n    \n    # convert DataFrame to array\n    data = data.values[:, 1:]\n    \n    # transpose\n    data = data.T\n    data = data.astype(\"float32\")\n    \n    # convert array to PILImage\n    im = PILImage.create(Image.fromarray((data * 255).astype(np.uint8)))\n    im.save(f\"{SPEC_DIR}/{split}_spectrograms/{label}/{spec_id}.png\")\n```\n\n## Image Count by Class\n\n|Class|Count|\t\n| --- | --- |\n|gpd_vote\t|1052|\n|grda_vote\t|1431|\n|lpd_vote\t|1302|\n|lrda_vote\t|693|\n|other_vote\t|4677|\n|seizure_vote\t|1983|\n\n## Image Height Statistics Overall\n\n|Stat|Value|\n| --- | --- |\n|count|11138.0|\n|mean|400.0|\n|std|0.0|\n|min|400.0|\n|25%|400.0|\n|50%|400.0|\n|75%|400.0|\n|max|400.0|\n\n## Image Width Statistics Overall\n\n|Stat|Value|\n| --- | --- |\n|count  |  11138.000000|\n|mean |      384.225714|\n|std   |     248.001019|\n|min   |     300.000000|\n|25%  |      301.000000|\n|50%  |      311.000000|\n|75%  |      354.000000|\n|max |      9116.000000|\n\n### Image Width Statistics By Class\n\n|Class|\t\t\tmean|\tmedian|\tmax|\tstd|\t\n| --- | --- | --- | --- | --- |\n|gpd_vote|\t435.895437|\t309.0|\t5281|\t348.815915|\n|grda_vote|\t360.069881|\t311.0|\t4038|\t183.385240|\n|lpd_vote|\t443.391705|\t315.0|\t9116|\t420.084127|\n|lrda_vote|\t376.523810|\t316.0|\t2950|\t189.161570|\n|other_vote|\t374.654907|\t304.0|\t5742|\t214.112803|\n|seizure_vote|\t360.663641|\t329.0|\t2631|\t124.085845|\n",
  "hasDescription": true,
  "isPrivate": false,
  "keywords": [
    "computer vision",
    "image",
    "health conditions"
  ],
  "licenses": [
    {
      "nameNullable": "Apache 2.0",
      "name": "Apache 2.0",
      "hasName": true
    }
  ],
  "collaborators": [],
  "data": []
}